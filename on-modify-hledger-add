#!/usr/bin/python

# taskwarrior-hledger-add-hook
# launch hledger add on completion of transaction-related tasks

# this is psudo-code, obviously..

# define transaction_task trigger (default = +txn)
# define hledger --file override (default = none)
# if is completed_task
#    continue
#    else exit
# if is transaction_task
#    continue
#    else exit

# read target journal file
#    test writable
#        else exit with error message
#    read modified time
#    read file size

# build hledger add command, space delimited
# hledger add [-f FILE] [date] [payee[comment]] [account1] [amount1] [account2] [amount2]
# comment starts with two spaces and a semicolon
# values with spaces need to be surrounded with apostrophes ('Payee Name  ;comment')
# values may be ommitted, but '' required to maintain sequence


# Payee
# omit first word of description (verb, eg. "pay", "buy", "deposit", etc.)
# identify "noun" (upper-cased word(s) following verb) becomes payee
# words following noun become comment
# example:
# pay Koodo Mobile cel phone bill
# becomes:
# 'Koodo Mobile  ;cel phone bill' (notice two spaces followed by semi-colon)
# if no upper-cased word(s) found then everything after verb (desc.startswith:word) is payee
# example:
# pay koodo mobile cel phone bill
# becomes:
# 'koodo mobile cel phone bill'

# Account1
# if exist uda.account.any: then account:value = Account1 
# else if has priject.any: then project:value = Account1
# else Account1 = nul

# Amount1
# if exist uda.amount.any: then amount:value = Amount1
# else Amount1 = nul

# build hledger add argument string, example:
# hledger add --file=myfile.journal today 'Koodo Mobile  ;cel phone bill' telcom

# issue hledger add command

# test is_journal_added_to
# if journal_mod_time > original_journal_mod_time
# and journal_file_size > original_journal_file_size
# exit

# else echo error message "journal entry failed! 
# undo task completion 
# exit
